

# devops-netology

1. 



2. Всего, при работе на 2,4ГГц, 13 каналов, из них не пересекаются между собой лишь 3, это 1-й, 6-й и 11-й.  
   


3. Производитель: Apple, Inc.

4. payload TCP сегмента = MTU - IPv4 header - TCP header = 9001 - 20 - 32 = 8949



5. Комбинация флага SYN и FIN, устанавливаемого в заголовке TCP, является недопустимой,
   поскольку она требует как установления соединения (через SYN), так и прекращения соединения (через FIN).



6. В State присутствует только UNCONN так, как в протоколе UDP нет концепции сессии, т.е. протокол
   не устанавливает соединение, от удаленного хоста не ожидается никакого ответа, в результате чего
   невозможно установить статус удаленного хоста, поэтому и состояние TIME-WAIT тоже не возможно, так как ожидать нечего.




7.  

<table>
<tr>
    <td> Client status</td>
    <td>Message</td>
    <td>Server status</td>
</tr>
<tr>
    <td>Established</td>
    <td>---FIN---></td>
    <td>Established</td>
</tr>
<tr>
    <td>FIN WAIT 1</td>
    <td><---ACK---</td>
    <td></td>
</tr>
<tr>
    <td>FIN WAIT 2</td>
    <td><---FIN---</td>
    <td>CLOSE WAIT</td>
</tr>
<tr>
    <td>TIME WAIT</td>
    <td>---ACK---></td>
    <td>LAST ACK</td>
</tr>
<tr>
    <td>CLOSED</td>
    <td></td>
    <td>CLOSED</td>
</tr>
</table>
   
8. Теоретически максимальное число соединений TCP порта 2 в степени 16 = 65536,
   следовательно, в теории, сервер может обслужить 65536 соединений от одного клиента.
   Если клиентов больше одного, то мы, опять же в теории, можем открыть 1 порт на каждого клиента
   т.е. 65536 портов и на каждом создать 65536 соединений от клиента.

9. Может, при большом количестве попыток установить сессию и закрыть сессию, если это происходит
   с большой частотой, то в следствии того, что при отключении сессии есть time-wait новая сессия может создаваться когда не закрыта предыдущая.
   Если подключения идут к  одной службе, то возможна ситуация когда закончится диапазон портов. 

10. В случае с TCP фрагментированный пакет при утере части фрагментов будет отправлен заново,
    так как используется контроль доставки. В случае UDP датаграмма, фрагмент которой утерян, будет отброшена и данные будут утеряны.
    При большой загрузке сети возможны серьезные просадки по качеству передаваемой информации, особенно данная проблема
    проявляется при передаче различного мультимедиа, например в SIP-телефонии.

11. Я бы сделал выбор зависти от критичности узла, даже скорее от критичности полноты логов получаемых с узла.
    Если это много устройств логи от которых нужны, но скажем достаточно повторяемы в периоде времени,
    такие как например ip-домофоны, ip-камеры, другие "умные устройства", то я бы выбрал UDP, чтобы 
    избыточно не нагружать сервер логов. В случае с серверами приложений, где необходима более подробная 
    информация в логах и полнота получения этой информации задействовал бы TCP.

12. $ sudo ss  state listening -t -p

        Recv-Q   Send-Q     Local Address:Port       Peer Address:Port   Process                                                     
        0        4096             0.0.0.0:sunrpc          0.0.0.0:*       users:(("rpcbind",pid=538,fd=4),("systemd",pid=1,fd=35))   
        0        4096       127.0.0.53%lo:domain          0.0.0.0:*       users:(("systemd-resolve",pid=539,fd=13))                  
        0        128              0.0.0.0:ssh             0.0.0.0:*       users:(("sshd",pid=992,fd=3))                              
        0        4096                [::]:sunrpc             [::]:*       users:(("rpcbind",pid=538,fd=6),("systemd",pid=1,fd=37))   
        0        128                 [::]:ssh                [::]:*       users:(("sshd",pid=992,fd=4))  

    В состоянии прослушивания 5 TCP портов, принадлежат systemd, sshd.

13. Для отображения в текстовом виде:

    $ sudo tcpdump  -A 

        tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
        listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
        02:47:40.168714 IP vagrant.ssh > _gateway.40116: Flags [P.], seq 2701538878:2701538914, ack 463859826, win 62780, length 36
        E..LY.@.@...
        ...
        .........6>...rP..<.O.....`.....E-..fV6...J...\....$..6..\.
        02:47:40.168768 IP vagrant.ssh > _gateway.40116: Flags [P.], seq 36:108, ack 1, win 62780, length 72
        E..pY.@.@...
        ...
        .........6b...rP..<.s....\...u.M.D.7]\..r.....@.7.'..$....hH.F..-.e..~.b4y .e :....Ja..@.`-4...
        02:47:40.168818 IP vagrant.ssh > _gateway.40116: Flags [P.], seq 108:144, ack 1, win 62780, length 36
        E..LY.@.@...
        ...
        .........6....rP..<.O...?.&.9BAy.3..(.[...-v;

    Для текстового и HEX:

    $ sudo tcpdump  -XX 

        tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
        listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
        02:50:10.628423 IP vagrant.ssh > _gateway.40116: Flags [P.], seq 2701542510:2701542546, ack 463860258, win 62780, length 36
                0x0000:  5254 0012 3502 0800 2714 86db 0800 4510  RT..5...'.....E.
                0x0010:  004c 5a1e 4000 4006 c86d 0a00 020f 0a00  .LZ.@.@..m......
                0x0020:  0202 0016 9cb4 a106 446e 1ba5 f222 5018  ........Dn..."P.
                0x0030:  f53c 184f 0000 9527 ea6d fa92 35cb 7fd4  .<.O...'.m..5...
                0x0040:  57aa 72f7 f574 9eb1 9816 7c10 aa28 0882  W.r..t....|..(..
                0x0050:  195f b31e 3943 063d 585c                 ._..9C.=X\
        02:50:10.628695 IP vagrant.ssh > _gateway.40116: Flags [P.], seq 36:72, ack 1, win 62780, length 36
                0x0000:  5254 0012 3502 0800 2714 86db 0800 4510  RT..5...'.....E.
                0x0010:  004c 5a1f 4000 4006 c86c 0a00 020f 0a00  .LZ.@.@..l......
                0x0020:  0202 0016 9cb4 a106 4492 1ba5 f222 5018  ........D...."P.
                0x0030:  f53c 184f 0000 2a93 e676 9d12 3ca7 e718  .<.O..*..v..<...
                0x0040:  3c13 e9b1 d313 cb48 9bf5 a160 d317 d0cb  <......H...`....
                0x0050:  6832 84f1 02dc 65ad 581e                 h2....e.X.
        02:50:10.628770 IP _gateway.40116 > vagrant.ssh: Flags [.], ack 36, win 65535, length 0
                0x0000:  0800 2714 86db 5254 0012 3502 0800 4500  ..'...RT..5...E.
                0x0010:  0028 09dd 0000 4006 58e3 0a00 0202 0a00  .(....@.X.......
                0x0020:  020f 9cb4 0016 1ba5 f222 a106 4492 5010  ........."..D.P.
                0x0030:  ffff 0799 0000 0000 0000 0000            ............
        02:50:10.628974 IP _gateway.40116 > vagrant.ssh: Flags [.], ack 72, win 65535, length 0



14. Флаги IP:
    Flags: 0x4000, Don't fragment
        
        0... .... .... .... = Reserved bit: Not set # первый бит всегда равен 0
        .1.. .... .... .... = Don't fragment: Set # 2-й бит, определяет возможность фрагментации пакета.
                                                   в данном случае установлен в 1(не фрагментирован)   
        ..0. .... .... .... = More fragments: Not set # 3-й бит, показывает не является ли этот пакет
                                                        последним в цепочке пакетов.

    Стандарт Ethernet называется Ethernet II

    OUI в дампе можно увидеть в заголовке Ethernet:
            
        Ethernet II, Src: PcsCompu_14:86:db (08:00:27:14:86:db), Dst: RealtekU_12:35:02 (52:54:00:12:35:02)
        Destination: RealtekU_12:35:02 (52:54:00:12:35:02)
            Address: RealtekU_12:35:02 (52:54:00:12:35:02)






   
 
